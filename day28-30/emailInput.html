<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>day28-30</title>
    <style>
        li {
            list-style: none;
            background-color: pink;
        }

        ul {
            padding-left: 0;
            margin: 0;
            width: 166px;
        }

        li:hover {
            background-color: limegreen;
        }
    </style>
</head>
<body>
<div class="wrapper">
    <input id="email-input" type="text">
    <ul id="email-sug-wrapper" class="email-sug"></ul>
</div>

<script>
    var postfixList = ['163.com', 'gmail.com', '126.com', 'qq.com', '263.net'];

    function getValue() {
        var textValue = document.getElementById("email-input").value;
        return textValue.trim();
    }

    function setText() {
        var selectText = "";
        var textValue = getValue();
        var substr = "";
        var beforeText = "";
        if (textValue.search("@") < 0)
            textValue = textValue + "@";
        else {
            var substr = textValue.substring(textValue.search("@") + 1);
            textValue = textValue.substring(0, textValue.search("@") + 1);
        }
        for (var i = 0; i < postfixList.length; i++) {
            selectText = selectText + "<li>" + textValue + postfixList[i] + "</li>";
            // console.log(postfixList[i].substring(0, substr.length))
            if (substr == postfixList[i].substring(0, substr.length) && substr != "") {
                beforeText = beforeText + "<li>" + textValue + postfixList[i] + "</li>";
            }
        }
        if (beforeText == "")
            return selectText;
        else
            return beforeText;
    }

    function setWrapper() {
        document.getElementById("email-sug-wrapper").innerHTML = setText();
    }

    function inputStatus() {
        var value = getValue();
        if (value == "") {
            hiddenInput();
        } else {
            showInput();
        }
    }

    function hiddenInput() {
        document.getElementById("email-sug-wrapper").style.visibility = "hidden"
    }

    function showInput() {
        document.getElementById("email-sug-wrapper").style.visibility = "visible"
    }

    // function selectClick() {
    //     var tagLi = document.getElementsByTagName("li");
    //     console.log(tagLi)
    //     for (var i = 0; i < tagLi.length; i++) {
    //         var li = tagLi[i];
    //         tagLi[i].onclick = function () {
    //             document.getElementById("email-input").value = li.innerText;
    //         }
    //     }
    //
    // }

    document.getElementById("email-sug-wrapper").addEventListener('click', function (e) {
        if (e.target && e.target.nodeName.toUpperCase() == "LI") {/*判断目标事件是否为li*/
            document.getElementById("email-input").value = e.target.innerText;
            hiddenInput();
        }
    }, false)

    document.getElementById("email-input").oninput = function () {
        inputStatus();
        setWrapper();
    }
</script>
</body>
</html>